# Настройка ProxyAPI для AI-консультанта

## Что такое ProxyAPI?

ProxyAPI — российский сервис-прокси для доступа к моделям OpenAI и Anthropic из России.

**Доступные модели:**
- GPT-4o Mini
- O1 Mini / O1
- Claude 3 Haiku / Claude 3.5 Sonnet / Claude 3 Opus

## Как получить API ключ

1. Перейдите на сайт: https://proxyapi.ru
2. Зарегистрируйтесь / войдите в аккаунт
3. Пополните баланс (минимум 100 рублей)
4. Перейдите в раздел "API Keys"
5. Создайте новый ключ (начинается с `sk-`)

## Как добавить ключ в систему

### Через админ-панель (для всех пользователей)

1. Откройте админ-панель: 
   - **Обычные пользователи:** `https://ai-ru.ru/ваш-slug/admin`
   - **Суперадмин:** `https://ai-ru.ru/sales/admin`
2. Перейдите на вкладку **"AI"** 
3. Прокрутите вниз до раздела **"Как настроить API ключи"** (там есть инструкции для всех провайдеров)
4. Ниже найдите карточку **"API ключи бота"**
5. Найдите секцию **"ProxyAPI"** (зелёная карточка)
6. Вставьте ваш ключ в поле **"ProxyAPI Key"**
7. Нажмите **"Сохранить ключи"**

### Через SQL (только для разработчиков)

```sql
INSERT INTO t_p56134400_telegram_ai_bot_pdf.tenant_api_keys 
(tenant_id, provider, key_name, key_value, is_active)
VALUES (ВАШ_TENANT_ID, 'proxyapi', 'api_key', 'sk-YOUR-KEY-HERE', true)
ON CONFLICT (tenant_id, provider, key_name) 
DO UPDATE SET key_value = EXCLUDED.key_value, is_active = true;
```

## Как выбрать модель ProxyAPI

1. В админ-панели перейдите на вкладку **"AI"**
2. В карточке **"Настройки AI"** найдите раздел **"Провайдер AI"** 
3. Выберите **"ProxyAPI (OpenAI/Claude через RU прокси)"**
4. В разделе **"Модель AI"** выберите нужную модель:
   - **GPT-4o Mini** — быстрая и дешевая модель OpenAI
   - **O1 Mini / O1** — модели с улучшенным reasoning
   - **Claude 3 Haiku** — быстрая модель Anthropic
   - **Claude 3.5 Sonnet** — топовая модель Anthropic (рекомендуется)
   - **Claude 3 Opus** — самая мощная модель Anthropic

5. Нажмите **"Сохранить настройки"**

## Проверка работоспособности

После добавления ключа:

1. Откройте веб-чат на сайте или Telegram-бота
2. Отправьте любое тестовое сообщение: `привет`
3. Если бот ответил — всё работает! ✅

Если видите ошибку **"API ключ не настроен: proxyapi.api_key"**:
- Убедитесь, что ключ сохранён в админ-панели
- Проверьте, что выбран провайдер **"ProxyAPI"** в настройках AI
- Убедитесь, что на балансе ProxyAPI есть средства

## Текущая настройка tenant 777

**Провайдер:** ProxyAPI  
**Модель:** gpt-4o-mini  
**Статус ключа:** ❌ Не добавлен (нужно добавить через админ-панель)

**Доступные провайдеры с ключами:**
- ✅ Yandex (api_key + folder_id)
- ✅ OpenRouter (api_key)
- ❌ ProxyAPI (api_key) — требуется добавить

## Стоимость ProxyAPI

Примерные цены (актуальность уточняйте на proxyapi.ru):
- **GPT-4o Mini:** ~5 руб / 1M токенов
- **Claude 3 Haiku:** ~10 руб / 1M токенов  
- **Claude 3.5 Sonnet:** ~150 руб / 1M токенов
- **O1 Mini:** ~50 руб / 1M токенов

## Альтернативы ProxyAPI

Если ProxyAPI не подходит, рассмотрите:

1. **OpenRouter** — бесплатные модели (Llama, Gemma, Qwen, DeepSeek R1)
   - Уже настроен для tenant 777 ✅
   
2. **YandexGPT** — российская модель
   - Уже настроен для tenant 777 ✅

Переключиться можно в **"Настройки AI"** → **"Провайдер AI"**.